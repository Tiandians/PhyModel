# 小球碰撞模型的物理分析、算法设计和基于OpenGL的可视化实现

小组成员：朱宝林、尤比佳、林佳诚、张宏彬
指导老师：黄罗华
摘要：
关键词：

## 第1章 绪论

### 1.1 研究背景
经过几个世纪的发展，数学、物理等基础学科理论已日益完善。随着研究内容越来越深入，其高度抽象的公式无法直观理解，复杂的计算难以靠人力来完成。现代科学研究常以数学、物理等基础学科作为理论基础，而将计算机作为计算和可视化工具。此次研究性学习，我们选取物理学的经典模型——小球碰撞为研究对象，进行物理理论分析，并尝试在计算机上模拟实现以此模型为基础的一些应用场景。

小球碰撞模型在物理研究中具有重要意义。物理学的一个重要方法是理想化模型。当物体自身形状可以忽略时，常常将其简化为小球或质点进行处理。借助小球碰撞模型，物理学家对理想气体的微观运动进行了深入探索。小球碰撞模型还在化学反应动态过程、元素相变、最密堆积问题、天体物理等领域具有广泛应用。

在现代科学研究中，计算机已经成为不可或缺的一环。计算机凭借其强大的性能和高效的算法，能够快速处理海量数据并得到准确的结果。利用可视化技术，研究人员得以实时观察数据情况，获得直观感受

### 1.2 研究目的与意义
通过此次研究，我们希望深入探索小球碰撞这一经典模型，学习物理研究的基本方法；探索在计算机上模拟物理过程，学习使用算法处理大量数据；学习使用图形库将研究结果可视化；学习运用科学研究方法探索、分析并解决问题，实际体验科学研究过程。这将极大地培养我们的和科学研究能力，为我们将来从事科学研究工作打下坚实基础。

### 1.3 研究内容
物理：刚性小球碰撞模型：物体模型、状态模型、过程模型

算法：碰撞检测、事件处理（排序）、驱动模拟

可视化：OpenGL库的使用

### 1.4 研究方法
实验法、文献研究法、模型方法、信息研究方法

## 第2章 物理分析
小球碰撞可以具体地分成三类问题：碰撞预测、检测和处理。为了研究这些问题，需要设计一个物理系统作为基础。

### 2.1 物理建模
一个简单的碰撞系统中有运动的小球和一些固定的障碍物。我们需要建立模型可以分为：实体物理模型、状态物理模型和过程物理模型。

* 实体物理模型：

运动物体：小球（质量m，半径r）

基础固定物体：平面、小球、长方体容器

我们记录平面上一点和法向量来描述平面，记录容器的每一个面来描述容器。

为了方便计算，我们只允许小球运动。质点的运动看起来简单，但它没有几何结构，碰撞方程的解具有不定性。

* 状态物理模型：

固定物体的状态就是它的位置。

小球的运动不需要考虑旋转，它具有的状态量有位置，速度。因为速度在运动过程中不变，所以是关于的线性函数。

### 2.2 过程分析
所有碰撞均为弹性碰撞，不考虑摩擦。

过程分析的方法将决定编程模型：时间驱动模型依赖于碰撞检测，事件驱动模型依赖于碰撞预测。各类物体的碰撞检测都已有非常详尽的研究，可以直接采用。本论文主要使用事件驱动模型，因此使用碰撞预测分析。

#### 2.2.1 碰撞预测

##### 2.2.1.1 球-球
球体占有到球心一定距离内的空间，可以利用空间中两点距离公式确定两球是否发生相撞。

设空间中两球位置分别为  和  ，两球速度为  和  ，两球半径分别为。

设两球在时刻相撞，则有：

令  可得一元二次方程：

$$\vec{v} (2.2)$$

计算方程判别式，若判别式  得到方程两根：

对方程根的情况分类讨论，可知：
1 若方程两根均小于0，则两球不会发生碰撞。（负根说明：若时间倒退，两小球可以发生碰撞）
2 若方程两根不都小于0，则两球发生碰撞的时间是最小的非负实根
在实现中，还可以在计算前加上检验措施来提高准确度和效率。
1 提前进行碰撞检测，防止小球出现重叠：

若该式为真，则小球重叠。反之未重叠。
2 提前进行相离运动检测，减少计算：

若该式为真，则小球相离，不可能发生碰撞。


#### 2.2.2 碰撞处理
##### 2.2.2.1 球-球
任何维度的小球碰撞均可转化为沿球心连线方向的一维碰撞，在其他方向上运动状态不变。这是因为小球碰撞时，弹力的方向垂直于小球接触点的切面，从接触点指向球心。
假设t时刻两小球发生碰撞，取该时刻小球位置矢量相减并归一化得到球心连线的方向矢量
		(2.5)
将两小球的速度与方向矢量点乘得到速度在球心连线方向的分量
		(2.6)
在球心连线方向上（一维空间）处理小球碰撞，应用《力学》中联立动量、动能守恒方程得到的一维碰撞解
		(2.7)
计算该方向上速度变化量，将变化量乘以方向向量回到三维空间中，再加回原速度
		(2.8)
从而完成了一次小球碰撞的计算
### 2.3 应用
#### 2.3.1 理想气体
氧气分子直径0.346e-9m
标准状态下气体分子直径2.2414e-3/6.02214076e23开立方根=
一微米长度上可排列气体分子数6.452726e+02取为645个
一立方微米小球个数268336125
花粉粒子直径15～50微米
OPENGL流畅30fps最大小球个数2096
气体分子速率分布均值为0，标准差为2.664195e+02
计算过程下图

